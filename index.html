<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Curvas de Costo Medio</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body { font-family: sans-serif; margin: 40px; }
    #sliderContainer { margin-top: 30px; max-width: 500px; margin-left: auto; margin-right: auto; }
    label { font-weight: bold; }
    #kInputs { display: flex; gap: 10px; align-items: center; }
    input[type=number] { width: 80px; padding: 4px; }
  </style>
</head>
<body>
  <h2 style="text-align: center;">Curvas de Costo Medio: Corto vs Largo Plazo</h2>
  <div id="plot" style="max-width: 500px; margin: auto;"></div>

  <div id="sliderContainer">
    <label for="kSlider">Capital fijo en el corto plazo (K₀):</label>
    <div id="kInputs">
      <input type="range" min="1" max="50" value="4" step="0.1" id="kSlider">
      <input type="number" min="1" max="50" step="0.1" id="kInput" value="4">
    </div>
  </div>

  <script>
    const F = 10;
    const w = 1, r = 1;
    const qVals = Array.from({length: 200}, (_, i) => 0.5 + i * (7.5/199));

    function acLargoPlazo(q) {
      return (2 * q * q + F) / q;
    }

    function acCortoPlazo(q, K0) {
      const L = Math.pow(q / Math.pow(K0, 0.25), 4);
      return (w * L + r * K0 + F) / q;
    }

    function calcularCurvaCorto(K0) {
      return qVals.map(q => acCortoPlazo(q, K0));
    }

    function graficar(K0) {
      const acLP = qVals.map(acLargoPlazo);
      const acCP = calcularCurvaCorto(K0);

      const traceLP = {
        x: qVals,
        y: acLP,
        mode: 'lines',
        name: 'Largo plazo',
        line: { width: 3, color: 'blue' }
      };

      const traceCP = {
        x: qVals,
        y: acCP,
        mode: 'lines',
        name: `Corto plazo (K₀ = ${K0})`,
        line: { dash: 'dash', color: 'orange', width: 3 }
      };

      Plotly.newPlot('plot', [traceLP, traceCP], {
        margin: { t: 30 },
        xaxis: { title: 'Cantidad producida (q)' },
        yaxis: { title: 'Costo medio', range: [0, 40] },
        legend: { orientation: 'h' }
      }, {responsive: true});
    }

    const slider = document.getElementById('kSlider');
    const input = document.getElementById('kInput');

    function updateFromSlider() {
      const val = parseFloat(slider.value);
      input.value = val;
      graficar(val);
    }

    function updateFromInput() {
      let val = parseFloat(input.value);
      if (isNaN(val)) return;
      val = Math.min(Math.max(val, 1), 50);
      slider.value = val;
      input.value = val;
      graficar(val);
    }

    slider.addEventListener('input', updateFromSlider);
    input.addEventListener('change', updateFromInput);

    // Inicial
    graficar(parseFloat(slider.value));
  </script>
</body>
</html>
